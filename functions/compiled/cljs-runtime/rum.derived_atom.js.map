{"version":3,"sources":["rum/derived_atom.cljc"],"mappings":"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","names":["var_args","G__5790","rum.derived-atom/derived-atom","js/Error","refs","key","f","rum.derived_atom.derived_atom","opts","map__5801","cljs.core/--destructure-map","cljs.core.get","ref","check-equals?","recalc","G__5804","cljs.core/count","vec__5805","cljs.core.nth","a","G__5808","cljs.core/deref","vec__5809","b","G__5812","G__5813","vec__5814","c","G__5817","G__5818","G__5819","cljs.core.apply","cljs.core.map","sink","G__5823","cljs.core/reset!","cljs.core.atom","watch","_","new-val","cljs.core.not_EQ_","seq__5830","cljs.core/seq","chunk__5831","count__5832","i__5833","temp__5753__auto__","cljs.core/chunked-seq?","c__4638__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/first","cljs.core/next","cljs.core/add-watch"],"sourcesContent":["(ns ^:no-doc rum.derived-atom)\n\n(defn derived-atom\n  ([refs key f]\n   (derived-atom refs key f {}))\n  ([refs key f opts]\n   (let [{:keys [ref check-equals?]\n          :or {check-equals? true}} opts\n         recalc (case (count refs)\n                  1 (let [[a] refs] #(f @a))\n                  2 (let [[a b] refs] #(f @a @b))\n                  3 (let [[a b c] refs] #(f @a @b @c))\n                  #(apply f (map deref refs)))\n         sink   (if ref\n                  (doto ref (reset! (recalc)))\n                  (atom (recalc)))\n         watch  (if check-equals?\n                  (fn [_ _ _ _]\n                    (let [new-val (recalc)]\n                      (when (not= @sink new-val)\n                        (reset! sink new-val))))\n                  (fn [_ _ _ _]\n                    (reset! sink (recalc))))]\n     (doseq [ref refs]\n       (add-watch ref key watch))\n     sink)))\n"]}